<html>

<head>
  <title>Tasks Manager Dashboard</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="../libs/d3.v7.js">
    globalThis.d3 = d3;
  </script>
  <script src="private/credentials.js"></script>
  <script>
    function hideMap() {
      console.log("Hiding map");
      document.getElementById("map").style.display = "none";
    }
    function assignHrefVarName(href, varName) {
      const varTmp = href.substring(href.search(`${varName}=`) === -1 ? 0 : (href.search(`${varName}=`) + varName.length + 1));
      const varNameResult = varTmp === href ? href : varTmp.substring(0, varTmp.search("&") === -1 ? varTmp.length : varTmp.search("&"));
      if (!varNameResult.length) {
        console.error(`At least ${varName} was missing via href`);
      }
      return varNameResult;
    }
    function handleCredentials() {
      const credentials_list = [
        "cesium_api_key", "idealista_api_key", "idealista_api_secret", "monday_key"
      ];
      const loaded_credentials = credentials_list.map(credential => {
        if (!credential in window) {
          console.error(`At least ${credential} was missing via private folder`);
          return false;
        }
        return true;
      });
      if (!loaded_credentials.filter(credential => !credential).length) {
        console.log("Credentials loaded via private folder");
        return;
      }
      const url = window.location.href;
      const href = url.substring(url.indexOf("#") + 1);
      credentials_list.map(credential => window[credential] = assignHrefVarName(href, credential));
      console.log("Credentials done loading via href");
    }
    handleCredentials();
  </script>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.103/Build/Cesium/Cesium.js"></script>
  <link href="../style/style.css" rel="stylesheet">
  <link href="../style/cesium-widgets-1.103.css" rel="stylesheet">
  <link rel="shortcut icon" type="image/x-icon" href="../public/real-estate-investing-management.ico">
  <style>
    a,
    b,
    body,
    fieldset,
    legend,
    span,
    table,
    td {
      font-size: 0.88em;
    }

    svg {
      font-weight: bold !important;
    }
  </style>
</head>

<body class="top-flex-container-2 flex-container-2" style="height:calc(100% - 2em); width:calc(100% - 1.2em)">
  <div id="taskManager" style="width:min(99vw, 840px); height:min(calc(100% - 1em), 800px)"></div>
  <div id="timeGraphs" style="width:min(99vw, 600px); height:min(calc(100% - 1em), 800px); position:relative">
    <iframe style="position:absolute; display:block; top:-1em; opacity:0.5; width:600; height:440; border-width:0" src="
			https://calendar.google.com/calendar/embed?
				bgcolor=%23000000
				&color=%23000000
				&ctz=Europe%2FCopenhagen
				&height=440
				&mode=WEEK
				&showCalendars=0
				&showNav=1
				&showPrint=0
				&showTabs=0
				&showTitle=0
				&showTz=0
				&src=MW9vMWliZ2RmbWtuYzBkMWVobWhkZTg3cnNAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ
				&wkst=2
		"></iframe><!--				&color=%23 #7986CB-->
    <div id="tasksByCategoryAndDay"></div>
  </div>
  <div id="popUpDiv" style="width: 2.6em; height: 1.2em; position: absolute; right: 5em; top: 0.8em;"></div>
  <script src="../assets/tasksManager.js"></script>
  <script src="../assets/tasksManager.jsx"></script>
  <!--<div id="map" style="width:min(99vw, 600px); height:calc(100% - 1em); position:relative">
    <button class="close-button" onClick='hideMap()'>
      &times; <span style="display:none">👁</span>
    </button>
  </div>
  <script src="../assets/cesiumInit.js"></script>-->
</body>

</html>