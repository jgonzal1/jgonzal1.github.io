<html>

<head>
  <title>Tasks Manager Dashboard</title>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js">
    globalThis.React = React;
  </script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js">
    globalThis.ReactDOM = ReactDOM;
  </script>
  <script src="../libs/d3.v7.js">
    globalThis.d3 = d3;
  </script>
  <script src="private/credentials.js"></script>
  <script>
    function hideMap() {
      console.log("Hiding map");
      document.getElementById("map").style.display = "none";
    }
    function assignHrefVarName(href, varName) {
      const varTmp = href.substring(href.search(`${varName}=`) === -1 ? 0 : (href.search(`${varName}=`) + varName.length + 1));
      const varNameResult = varTmp === href ? href : varTmp.substring(0, varTmp.search("&") === -1 ? varTmp.length : varTmp.search("&"));
      if (!varNameResult.length) {
        console.error(`At least ${varName} was missing via href`);
      }
      return varNameResult;
    }
    function handleCredentials() {
      const credentials_list = [
        "cesium_api_key", "idealista_api_key", "idealista_api_secret", "monday_key"
      ];
      const loaded_credentials = credentials_list.map(credential => {
        if (!credential in window) {
          console.error(`At least ${credential} was missing via private folder`);
          return false;
        }
        return true;
      });
      if (!loaded_credentials.filter(credential => !credential).length) {
        console.log("Credentials loaded via private folder");
        return;
      }
      const url = window.location.href;
      const href = url.substring(url.indexOf("#") + 1);
      credentials_list.map(credential => window[credential] = assignHrefVarName(href, credential));
      console.log("Credentials done loading via href");
    }
    handleCredentials();
  </script>
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.103/Build/Cesium/Cesium.js"></script>
  <link href="../style/style.css" rel="stylesheet">
  <link href="../style/cesium-widgets-1.103.css" rel="stylesheet">
  <link rel="shortcut icon" type="image/x-icon" href="../public/real-estate-investing-management.ico">
  <style>
    a,
    b,
    body,
    fieldset,
    legend,
    span,
    table,
    td {
      font-size: 0.88em;
    }

    /*path.slice {
      stroke-width: 2px;
    }

    polyline {
      opacity: 0.3;
      stroke: #000;
      stroke-width: 2px;
      fill: none;
    }*/

    svg {
      /*width: 100%;
      height: 100%;*/
      font-weight: bold !important;
    }
  </style>
</head>

<body class="top-flex-container-3 flex-container-3" style="height:calc(100% - 2em); width:calc(100% - 1.2em)">
  <div class="sidebar">Sidebar</div>
  <div id="taskManager" style="width:min(99vw, 840px); height:min(calc(100% - 1em), 800px)"></div>
  <div id="calendar" style="width:min(99vw, 600px); height:min(calc(100% - 1em), 800px); position:relative;">
    <iframe
      style="position:absolute; display:block; top:0; opacity:0.8; width:600; height:780; border-width:0; border: 1px solid #CCC"
      src="
			https://calendar.google.com/calendar/embed?
				bgcolor=%23000000
				&color=%23000000
				&ctz=Europe%2FCopenhagen
				&height=760
				&mode=WEEK
				&showCalendars=0
				&showNav=1
				&showPrint=0
				&showTabs=0
				&showTitle=0
				&showTz=0
				&src=MW9vMWliZ2RmbWtuYzBkMWVobWhkZTg3cnNAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ
				&wkst=2
		"></iframe><!--				&color=%23 #7986CB
    <div id="tasksByCategoryAndDay"></div>-->
  </div>
  <div id="popUpDiv" style="width: 2.6em; height: 1.2em; position: absolute; right: 5em; top: 0.8em;"></div>
  <script src="../assets/tasksManager.js"></script>
  <script src="../assets/tasksManager.jsx"></script>
  <script type="text/babel">
    const urlPrefix = location.href.substring(0, location.href.search("/pages/"));
    console.log(urlPrefix)
    const sideBarDom = document.getElementsByClassName('sidebar')[0];
    const sideBarRoot = globalThis.ReactDOM.createRoot(sideBarDom);
    sideBarRoot.render(
      <div className="space-children-05em">
        <a href="#CV" onClick={() => document.location = urlPrefix + '/index.html'}>
          <img src="../public/cv.png" />
        </a>
        <a href="#Music" onClick={() => document.location = urlPrefix + '/pages/music.html'}>
          <img src="../public/music.png" />
        </a>
        <a href="#Navezgane map" onClick={() => document.location = urlPrefix + '/pages/navezgane.html'}>
          <img src="../public/zombie.png" />
        </a>
        <a href="#Tasks dashboard" onClick={() => document.location = urlPrefix + '/pages/tasksDashboard.html'}>
          <img src="../public/prioritize.png" />
        </a>
        <a href="#The three seas map" onClick={() => document.location = urlPrefix + '/pages/theThreeSeas.html'}>
          <img src="../public/map.png" />
        </a>
      </div>
    )
  </script>
  <!--
  <script type="text/babel" src="../assets/sideBarHandler.jsx"></script>
  <div id="map" style="width:min(99vw, 600px); height:calc(100% - 1em); position:relative">
    <button class="close-button" onClick='hideMap()'>
      &times; <span style="display:none">üëÅ</span>
    </button>
  </div>
  <script src="../assets/cesiumInit.js"></script>
  -->
</body>

</html>